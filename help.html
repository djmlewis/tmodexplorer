<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Help</title>
  </head>
  <body>
    <h1>Contents</h1>
    <ul>
      <li><a href="#Introduction">Introduction</a></li>
      <ul>
        <li><a href="#Plots">Plots</a></li>
        <li><a href="#Data_Tables_">Data Tables</a></li>
        <li><a href="#Saving_Gene_Probe_ProbeNames_and_">Saving Gene,
            Probe, ProbeNames and Module Lists</a></li>
      </ul>
      <li><a href="#The_Datasets">The Datasets</a></li>
      <ul>
        <li><a href="#Transcriptomics_Data_">Transcriptomics Data</a></li>
        <li><a href="#Cytokines_Data_">Cytokines Data</a></li>
      </ul>
    </ul>
    <h1><a name="Introduction"></a>Introduction</h1>
    The purpose of this app is just to visualise the expression of genes
    as a time course after immunisation, either alone or when clustered
    into Blood Transcriptional Modules (BTMs); and to look inside the
    BTMs to observe how the individual genes are responding to the
    vaccine stimulus. <br>
    <br>
    The datasets are composed of rows of data where each row is a probe
    on the chip, and the columns contain the group mean value (raw
    expression or fold-increase from baseline) for that probe. The
    groups are a specific <b>treatment~timepoint</b> combination: e.g.
    Boostrix~Day 1, Placebo~Day 0, etc.<br>
    <br>
    The basic concept is to pick a particular time point and vaccine - <i>e.g.
































      Day 7 after immunisation with Boostrix</i> - and then sort the
    probes or genes values present in the array as they are on that
    timepoint ~ vaccine. So you may have the probes ordered in
    descending order by their value (fold-increase from baseline or mean
    expression) on day 1 in those people who got Boostrix. Why do this?
    Well, because with over 60k probes you have to order them somehow.
    The grouping by <i><b>treatment</b></i> (vaccine or placebo) ~ <i><b>time</b></i>
    combination is actually a natural grouping, if a bit
    counter-intuitive when comparing between vaccines. As the data
    consists of rows where each row is a probe, and where each column
    has values for one treatment (vaccine or placebo) ~ time
    combination, by sorting the rows according to the values for one
    selected treatment ~ time combination, you also impose the same
    order on the probes at other time points and vaccines.<br>
    <br>
    Having ordered the top or bottom probes, or found probes with values
    between a range, you can then place the probes or genes into a group
    of interest - e.g. the top 10 fold-increased genes on day 7 after
    Boostrix. <i><b>This set of selected genes becomes the core
        building-block of subsequent analysis</b></i>. You can identify
    how the expression of these genes changes over time (in all the
    treatment groups); which modules these genes belong to; observe how
    the other genes in those modules are responding over time; or how
    the whole module responds over time. You can treat these selected
    genes as a 'pseudo-module' and see how this module changes over time
    in comparison with the predefined modules in tmod. Other search
    options allow you to identify genes by their title or description
    instead of (or as well as-) their expression values at a specific
    treatment~time, and then follow these selected genes and the modules
    that contain them over time.<br>
    <br>
    The figures below illustrates this: the probes in the combined ABC
    Surrey dataset have been sorted in <i>descending order of their
      expression value in the vaccinees 7 days after receiving Stamaril</i>.
    The top 10 probes have been selected and the time series plotted as
    individual lines for Stamaril, Fluad and Placebo, or as a boxplot
    for these probes treated as though they belonged to a pseudo-module.<br>
    <br>
    <div align="center"><img src="selgenesseries.png" alt="Selected
        Probes" height="250" width="554"> &nbsp;<img
        src="selgenesseriesbox.png" alt="Selected Probes Boxplot"
        height="250" width="554"><br>
    </div>
    <br>
    We can then identify the modules to which those genes belong, and
    plot the changes in those modules over time. Note that while the
    kinetics of the probes is clear-cut, the modules are less so, with
    some non-responding modules. This reflects that fact that modules
    contain many genes that may not be responding to Stamaril at all, or
    even down-regulated, as&nbsp; the modules have been clustered by
    their authors on the basis of other criteria:<br>
    <div align="center"><img src="selmods.png" alt="Selected Modules"
        height="249" align="middle" width="550">&nbsp;&nbsp; <img
        src="selmodsseries.png" alt="Selected Modules Timecourse"
        height="249" align="middle" width="550"><br>
    </div>
    <br>
    When plotting the time-course of genes as an average of the probes,
    it may become apparent by wide SEM ribbons that probes mapping the
    same gene are behaving discordantly. It is possible to split the
    gene averages back into the component probes to identify which genes
    have aberrant probes using the <a href="#Gene%E2%AB%B7Probes"><b>Gene⫷Probes</b></a>
    option. For example, as shown in the figure below for some top genes
    upregulated on day 7 after Stamaril, while the two IFIT2 probes
    (red) respond similarly, one of the OAS2 probes (green) is a log2
    lower than the other two, and the two RSAD2 probes are far apart
    (blue). These discrepancies are also seen in the wide SEM ribbons.<br>
    <div align="center"><img src="probessplit.png" alt="Genes Split Into
        Probes" height="250" width="640"><br>
    </div>
    <br>
    <br>
    Choosing the correct day to sort the probes by is important as the
    kinetics of responding genes varies significantly. For example
    sorting on day 1 after Fluad brings up genes with a very sharp
    kinetics associated with cytokines etc. Sorting on day 7 brings up
    genes mapping to immunoglobulins with a broader kinetics. Notably
    whereas Day 1 genes map reasonably well to modules, none of the top
    10 day 7 genes map to any tmod modules. Sorting on day 5 brings up a
    new set of genes together with some of the day 7 genes.<br>
    <div align="center"><img src="day1genesmodules.png" alt=""
        height="250" width="311"><img src="day7genesmodules.png" alt=""
        height="250" width="348"><br>
      <img src="day1genes.png" alt="" height="250" width="679"><img
        src="day7genes.png" alt="" height="250" width="679"><br>
      <img src="day5genes.png" alt="" height="250" width="679"><br>
    </div>
    <br>
    <br>
    <br>
    There is also an option to go straight to exploring by modules, in
    which case you just select tmod modules and observe their response
    over time. Modules can be selected in the the same way as individual
    probes or genes - by identifying those most up- or down-regulated
    modules for a selected treatment ~ time; or by searching for modules
    by name or category. The basic concept is the same, as shown here
    where the <i>top 10 modules up-regulated on day 7 after Stamaril</i>
    are identified, and the response over time plotted. Modules can be
    further selected by <i>Title</i> and <i>Category</i>. The plots
    below actually show the 8 <i>Titles</i> that these top 10 modules
    belong to. Note that the kinetics is more clear-cut because we have
    forced the selection to focus on the aggregate expression of modules
    - this may not be very representative of the actual responding genes
    (as shown above): <br>
    <div align="center"><img src="topmods.png" alt="Top Modules"
        height="250" width="553">&nbsp;&nbsp; <img
        src="topmodsseries.png" alt="Top Modules Timecourse"
        height="250" width="553"><br>
    </div>
    <br>
    By visualising the changes in gene and module expression we can ask
    how do the tmod modules respond after immunisation and how does this
    compare when we select individual genes? Are there other gene
    groupings that may be better? Do some modules have so many
    non-responding genes that they are not representative? Could we
    cluster new modules?<br>
    <h3><a name="Plots"></a>Plots</h3>
    <p><b><em>Plots may take some time to appear - be patient!</em></b>
      The more rows you select for plotting the slower it will be.
      ggplot2 is not good at providing progress updates - so it may look
      like nothing is happening. Some plots are drawn automatically and
      these offer the choice of using R base graphics (faster) or
      ggplot2 (slower but may be prettier). Other plots have a <b>Plot</b>
      button, and will only draw or update when that is clicked, to
      avoid slow refreshes when you alter several options. Plots have a
      slider control&nbsp;<img alt="" src="slider.png" height="20"
        width="82"> to change the height. Plot width always resizes
      automatically with the window width. A low resolution image of
      plots can be copied or saved by right-clicking on the plot, while
      clicking <b>⤓ Plot As PNG</b> button downloads a high resolution
      image. The plotting parameters are not sophisticated, but
      generally the data used to create the plot are in a table below
      and can be saved and imported into R or other packages for
      plotting. Some tables can be saved as PNG files to incorporate
      with plots as graphics.<br>
    </p>
    <h4>Identifying data on line plots by hovering over points<br>
    </h4>
    <p>When data are plotted as <b>Lines</b> it is sometimes difficult
      to identify the individual data series by colour. They can be
      identified by hovering the mouse cursor over a <b>point</b> (or
      where a point would be plotted if you are not displaying points).
      Hovering over line segments between points does nothing. A
      notification window will appear displaying the data for this
      point, which can be copied. It will disappear after 15 seconds, or
      be updated if a new point is selected. If lines are bunched then
      use the slider above the plot to increase the height.<br>
    </p>
    <p> </p>
    <h3><a name="Data_Tables_"></a>Data Tables<br>
    </h3>
    The entire data table can be searched using the box above,&nbsp; or
    individual columns searched using the boxes below each column.
    Tables can be downloaded as a csv file suitable for opening in Excel
    or R by clicking the <b>⤓ Table</b> button. A PNG image of the data
    table can also be downloaded in some cases by clicking the button <b>⤓
      Table as PNG</b>. This can be pasted onto graphics. It is very
    tricky to calculate the width correctly using grid.table, so the
    image may be clipped or extra wide, but a transparent background
    will be generated.<br>
    <br>
    <h3><a name="Saving_Gene_Probe_ProbeNames_and_"></a>Saving Gene,
      Probe, ProbeNames and Module Lists<br>
    </h3>
    When you have selected genes, probes or modules using some filters,
    they can be downloaded as a text file in a comma-separated format
    suitable for pasting into the 'regex' search boxes.<br>
    <h1><a name="The_Datasets"></a>The Datasets</h1>
    <h2><a name="Transcriptomics_Data_"></a>Transcriptomics Data<br>
    </h2>
    <p>The&nbsp; transcriptomics datasets have been uploaded to the
      server, but must be selected and loaded into the app before use.
      They come in two versions: <b>fold-increase in the log2
        expression values</b> (by subtraction of the log2 expression
      values), <i>always from day 0</i> <i>baseline</i> (in Surrey day
      -1 is treated as a time point preceding day 0); and <b>raw log2
        expression values</b>. Day 0 at 8AM was selected for Surrey as
      baseline as participants entered the unit on day -1. The data were
      calculated by initially grouping the raw data for each person -
      each probe - each time point, into treatment and time point pools.
      Then row averages for each probe within the treatment ~ time pool
      were calculated. This gives the basic raw expression data which is
      the group mean for each vaccination-day for each probe, i.e. the
      mean expression for Probe X on day Y for participants who received
      vaccine Z.<br>
    </p>
    <p>One group of datasets, based on <i><b>limma-normalised</b></i>
      expression values, consists of the <b> protocol-defined grouping
        of the vaccines and associated placebo group</b>:<br>
    </p>
    <ul>
      <li>D Gent Fluad-Placebo (<i>NB only 6 in placebo group</i>)<br>
      </li>
      <li>D2 Gent Boostrix-Placebo (<i>NB days 2 and 3 contain mutually
          exclusive halves of the cohort</i><i>, placebo = 20</i>)</li>
    </ul>
    The D and D2 data are derived from exported files, and are
    problematic in that the rows do not have proper <b>Probe IDs</b>. I
    have included a ProbeName identifier to link the Probe identifier
    (row ID) to the chip Probe Identifier but there appear to be
    duplications and other issues. <b>These two datasets must therefore
      be treated with caution</b>. The lack of a proper consistent Probe
    ID also prevents comparison with the Surrey data or between D and
    D2.<br>
    <ul>
    </ul>
    <p>I have also included a <b>combined Surrey dataset</b> in which
      the vaccines in A, B and C are all together, based on <i><b>agilent</b></i><i><b>-normalised</b></i>
      expression values. This dataset appears to be slightly better than
      the D and D2, but has been normalised differently. In this dataset
      the PLACEBO group contains all ~21 participants pooled from AB1C.
      "A" = Stamaril, Varilrix and Placebo; "C" = Fluad, Agrippal &amp;
      Placebo.&nbsp; For <b>Engerix B</b> the participants were naive
      and received a priming vaccination alongside a placebo group: this
      is indicated as ENGERIXB and PLACEBO in the same way as A &amp; C.
      The same participants then had a second immunisation (first boost)
      without any systems biology. They then came for a third
      immunisation (second boost) on day 167. This is represented in the
      dataset as EngerixB3 and PLACEBO3. The time points for
      ENGERIXB3/PLACEBO3 have been adjusted so that Day 167 becomes -1,
      and 168 day 0. <i>Fold-increase is then calculated from this
        adjusted day 0</i>, as the response to the third immunisation.
      Thus the ENGERIXB and PLACEBO have been pooled with the AC Surrey
      trials, but the ENGERIXB3 and&nbsp; the PLACEBO3 (<i>which</i><i>
        has only 4 participants)</i> are presented as a separate group,
      and PLACEBO3 should probably be ignored. This is a large dataset
      and so can be slow, but allows very convenient comparison between
      vaccines. This dataset therefore has the pattern: </p>
    <ul>
      <li>ABB3C Surrey Agilent</li>
    </ul>
    <h2><a name="Cytokines_Data_"></a>Cytokines Data<br>
    </h2>
    <p>The&nbsp; cytokines dataset has been uploaded to the server and
      loads automatically on start up. It is a single combined dataset
      with data from Surrey ABC trials, and Gent Fluad (D). No cytokine
      data are available for the Gent Boostrix trial (D2). The data have
      been handled in a similar way to the transcriptomics ABC Surrey
      Agilent (see above) with the addition of D. There is a single
      placebo group for Surrey AB1C, pooled from all participants, plus
      a separate PlaceboB3 group of those who had the second Engerix B
      immunisation. Fluad Gent is separate with its own placebo group
      (with only 6 participants), and also has only a subset of
      available days.</p>
    <p> Two versions of data are available: <b>actual concentrations</b>,
      and <b>fold-increase from day 0</b>, which can be selected using
      radio buttons on the Plot panel. For fold increase, if the day 0
      value was zero or absent for a particular participant, then no
      fold increase can be calculated and the participant's data for
      that cytokine is absent from all calculations. The plot gives the
      option to show the group size per day (available data at import
      including NA and 0) and the N with usable data, so you can see the
      actual group size contributing to each day's mean/median value. As
      the data contain a lot of zero (below threshold of detection)
      values, the option to remove zero values from calculation of means
      and median/IQR also exists, so that the kinetics of only
      measurable responses can be plotted. For TREM1 there were some
      "OOR" values (out of range) which have just been replaced by NA on
      import, and hence deleted from calculations. No log
      transformations have been done, this is an option when plotting.<br>
    </p>
  </body>
</html>
